#pragma once

typedef struct {
    PEPROCESS Process;
    PEPROCESS CreatingProcess;
    ULONG InitialGraceExpired;
    LIST_ENTRY ListEntry;
} MyProcessInfo;

MyProcessInfo* LookupMyProcessInfo(PEPROCESS Process);
PEPROCESS LookupCreatingProcess(PEPROCESS Process);
BOOLEAN MyProcessInfoAllowOnce(PEPROCESS Process);
void FreeMyProcessInfo(MyProcessInfo* myProcessInfo);
MyProcessInfo* CreateMyProcessInfo(PEPROCESS Process, PEPROCESS CreatingProcess);
void InitializeMyProcessInfoList();
void FreeMyProcessInfoList();

extern EX_SPIN_LOCK MyProcessInfoListLock;
